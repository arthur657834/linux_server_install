http://blog.csdn.net/hitabc141592/article/details/22931179

yum -y install openldap-*

cd /etc/openldap/
cp /usr/share/openldap-servers/slapd.conf.obsolete slapd.conf

slappasswd
创建LDAP管理员密码

vi /etc/openldap/slapd.conf
+rootpw {SSHA}pfAJm+JJa4ec2y8GjTc8uMEJpoR5YKMn

cp /usr/share/openldap-servers/DB_CONFIG.example  /var/lib/ldap/DB_CONFIG
rm -rf /etc/openldap/slapd.d/*

service slapd restart
chkconfig slapd on
chown -R ldap:ldap /var/lib/ldap
chown -R ldap:ldap /etc/openldap/

slaptest  -f /etc/openldap/slapd.conf -F /etc/openldap/slapd.d

chown -R ldap:ldap /etc/openldap/slapd.d
service slapd restart

useradd ldapuser1
echo 123 | passwd --stadin ldapuser1

至此，这些用户仅仅是系统上存在的用户（存储在/etc/passwd和/etc/shadow上），并没有在LDAP数据库里，所以要把这些用户导入到LDAP里面去。但LDAP只能识别特定格式的文件 即后缀为ldif的文件（也是文本文件），所以不能直接使用/etc/passwd和/etc/shadow。 需要migrationtools这个工具把这两个文件转变成LDAP能识别的文件。

yum install migrationtools -y

cd /usr/share/migrationtools/
vi migrate_common.ph
# Default DNS domain
$DEFAULT_MAIL_DOMAIN = "test.com";

# Default base
$DEFAULT_BASE = "dc=test,dc=com";

./migrate_base.pl > /tmp/base.ldif
./migrate_passwd.pl  /etc/passwd > /tmp/passwd.ldif
./migrate_group.pl  /etc/group > /tmp/group.ldif

ldapadd -x -D "cn=admin,dc=example,dc=com" -W -f /tmp/base.ldif
ldapadd -x -D "cn=admin,dc=example,dc=com" -W -f /tmp/passwd.ldif
ldapadd -x -D "cn=admin,dc=example,dc=com" -W -f /tmp/group.ldif

service slapd restart

装NFS，并把ldapuser1的家目录做NFS共享.
yum install nfs* -y
vi /etc/exports
/home/ldapuser1         *(rw,no_root_squash)

重启nfs服务：
# service rpcbind restart
# service nfs restart

client:
yum install nss-pam-ldapd pam_ldap -y 

vi /etc/openldap/ldap.conf
+
BASE:dc=test,dc=com
URL:192.168.1.10    --->此处为LDAP Server IP













